### Git

- 特色
  - 可以離線操作避免遇到網路不穩
  - 完全複製變更
    - 速度快
    - 不容易發生衝突
  - 分散式系統
  
- 安裝
  
  - https://git-scm.com/download/win
  
- 開啟 git bash

  - pwd 確認當前位置

  - 建立資料夾

    ```bash
    mkdir demo
    ```

  - 切換目錄

    ```bash
    cd demo
    ```

  - 建立檔案

    ```bash
    touch a.txt
    ```

  - 編輯檔案

    ```bash
    vi a.txt
    ```

  - 輸入內容

    ```bash
    Hello, world!
    ```

  - 存檔離開

    ```bash
    :wq
    ```

  - 查看檔案

    ```bash
    cat a.txt
    # output: Hello, World!
    ```

  - 刪除資料夾

    ```bash
    # 回上層
    cd ..
    # 刪除
    rm -fr demo
    ```

- Demo

  - 建立資料夾

    ```bash
    mkdir git-demo
    cd git-demo/
    ```

  - 初始化

    ```bash
    git init
    # output:
    # Initialized empty Git repository in C:/Users/user/git-demo/.git/
    ```

  - 確認檔案
  
    > .git 刪除就掰惹
  
    ```bash
    # 顯示資料夾下檔案、隱藏檔並以直列顯示
    ls -al
    
    # output:
    # drwxr-xr-x 1 user 197121 0 七月   15 10:06 ./
    # drwxr-xr-x 1 user 197121 0 七月   15 10:04 ../
    # drwxr-xr-x 1 user 197121 0 七月   15 10:06 .git/
    ```
  
  - git 設定 (練習)
  
    ```bash
    git config --global
    git config --local # 只有當前目錄作用
    
    git config --global user.name "Kai"
    git config --global user.email "shadowkai0121@gmail.com"
    
    # 確認設置
    git config --list
    # local 設置會顯示在最底端
    ```
  
  - 設置常用指令暱稱 (練習)
  
    ```bash
    git config --global alias.st status
    git st
    
    # output:
    # On branch master
    # No commits yet
    # nothing to commit (create/copy files and use "git add" to track)
    
    git config --global alias.tree "log --oneline --decorate --graph --all"
    git config --global alias.cm "commit -m"
    git config --global alias.ls 'log --graph --pretty=format:"%h <%an> %ar %s"'
    git config --global alias.last "log -1 HEAD"
    ```
  
  - 送交
  
    ```bash
    git commit -m "say something"
    ```
  
    - 追蹤
  
      - git add . vs git add --all
  
        > 將目前目錄的變動建立 VS 全部變動
  
    - 不追蹤
  
      - .gitignore
        - [慣例使用內容](https://github.com/github/gitignore)
  
  - 修改送交內容
  
    ```bash
    git commit --amend -m "New Message"
    ```
  
  - 查詢送交紀錄
  
    ```bash
    git log
    git log -10 # 最近十筆紀錄
    git log --grep="fixed" # 查詢具有 fixed 的訊息
    ```
  
- 練習：新增一個 Commit

  - 修改專案內容

    ```bash
    touch a.txt b.txt
    ```

  - 查看數據庫狀態

    ```bash
    $ git st
    On branch master
    
    No commits yet
    
    Untracked files:
      (use "git add <file>..." to include in what will be committed)
    
            a.txt
            b.txt
    
    nothing added to commit but untracked files present (use "git add" to track)
    ```

  - 將檔案加入追蹤

    ```bash
    $ git add .
    
    $ git st
    On branch master
    
    No commits yet
    
    Changes to be committed:
      (use "git rm --cached <file>..." to unstage)
    
            new file:   a.txt
            new file:   b.txt
    ```

  - commit

    ```bash
    $ git cm "inti"
    [master (root-commit) 0af48a8] inti
     2 files changed, 0 insertions(+), 0 deletions(-)
     create mode 100644 a.txt
     create mode 100644 b.txt
    ```

  - 查看 commit 紀錄

    ```bash
    $ git log
    commit 0af48a8b1041011a976c8193b1342e1347967fda (HEAD -> master)
    Author: Kai <shadowkai0121@gmail.com>
    Date:   Mon Jul 15 11:11:03 2019 +0800
    
        inti
    ```

- 練習：修改最後一個紀錄

  > git commit --amend 可以使用編輯器開啟

  ```bash
  $ git commit --amend -m "init"
  [master 72e9068] init
   Date: Mon Jul 15 11:11:03 2019 +0800
   2 files changed, 0 insertions(+), 0 deletions(-)
   create mode 100644 a.txt
   create mode 100644 b.txt
  
  $ git log
  commit 72e90682713fdf6fc10379151e327abaa4d348a1 (HEAD -> master)
  Author: Kai <shadowkai0121@gmail.com>
  Date:   Mon Jul 15 11:11:03 2019 +0800
  
      init
  ```

- 練習：快速補送交

  > 沿用原本的 commit

  ```bash
  # 漏改的檔案
  $ vim a.txt
  
  # 補進前一個 commit
  $ git commit --amend --no-edit
  [master 533c8b7] init
   Date: Mon Jul 15 11:11:03 2019 +0800
   2 files changed, 0 insertions(+), 0 deletions(-)
   create mode 100644 a.txt
   create mode 100644 b.txt
  
  # 不會額外增加 commit 紀錄
  $ git log
  commit 533c8b7e7a807d6cae6ab138c7d891398d349393 (HEAD -> master)
  Author: Kai <shadowkai0121@gmail.com>
  Date:   Mon Jul 15 11:11:03 2019 +0800
  
      init
  ```

- 檢視

  - log vs show vs diff
    - log 看 commit 內容，show 看內容+變動，diff 看變動

- 練習：移除 log ，確保沒有人可以再把 log 送進數據庫
  - 刪除錯誤檔案
      ```bash
      $ touch system.log
      $ git add .
      $ git cm "add log"
      
      # 刪除檔案
      $ rm system.log
      $ git st
      On branch master
      Changes not staged for commit:
        (use "git add/rm <file>..." to update what will be committed)
        (use "git checkout -- <file>..." to discard changes in working directory)
      
              deleted:    system.log
      
      no changes added to commit (use "git add" and/or "git commit -a")
      
      $ git add .
      $ git commit -m "remove log"
      $ git st
      On branch master
      nothing to commit, working tree clean
      ```

  - 建立 .gitignore

    ```bash
    $ touch .gitignore
    $ vi .gitignore
    # 增加內容
    # *.log
    
    $ git add .
    $ git commit -m "ignore file"
    
    $ git log
    commit 20446794d8b3de1f19ced7280ef29c6fc1c593eb (HEAD -> master)
    Author: Kai <shadowkai0121@gmail.com>
    Date:   Mon Jul 15 11:38:02 2019 +0800
    
        ignore file
  ```
  
- 測試
  
    ```bash
    $ touch system.log
    
    # 無視了 system.log 檔案!
    $ git st
    On branch master
    nothing to commit, working tree clean
  ```
  
  
  
    